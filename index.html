<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to JPG</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: white;
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .converter-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .upload-area {
            border: 3px dashed #4a9eff;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            background: rgba(25, 40, 80, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            background: rgba(25, 40, 80, 0.6);
            transform: translateY(-5px);
        }
        
        .upload-area.highlight {
            background: rgba(25, 40, 80, 0.8);
            border-color: #00ff9d;
        }
        
        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #4a9eff;
        }
        
        .upload-text {
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        
        .file-input {
            display: none;
        }
        
        .btn {
            background: linear-gradient(to right, #4a9eff, #6a5af9);
            color: white;
            border: none;
            padding: 14px 35px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(74, 158, 255, 0.4);
            display: inline-block;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(74, 158, 255, 0.6);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .settings {
            background: rgba(25, 40, 80, 0.4);
            border-radius: 15px;
            padding: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-around;
        }
        
        .setting-group {
            flex: 1;
            min-width: 200px;
        }
        
        .setting-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #4a9eff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .setting-icon {
            font-size: 1.4rem;
        }
        
        .quality-slider {
            width: 100%;
            margin: 15px 0;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            outline: none;
        }
        
        .quality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .quality-value {
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
            color: #feb47b;
        }
        
        .dpi-select {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .dpi-option {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .dpi-option:hover {
            background: rgba(74, 158, 255, 0.3);
        }
        
        .dpi-option.selected {
            background: linear-gradient(to right, #4a9eff, #6a5af9);
            box-shadow: 0 0 10px rgba(74, 158, 255, 0.5);
        }
        
        .preview-section {
            display: none;
            background: rgba(25, 40, 80, 0.4);
            border-radius: 15px;
            padding: 25px;
            flex-direction: column;
            gap: 20px;
        }
        
        .preview-title {
            font-size: 1.4rem;
            text-align: center;
            color: #4a9eff;
        }
        
        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        
        .page-preview {
            width: 180px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }
        
        .page-preview:hover {
            transform: translateY(-5px);
        }
        
        .preview-img {
            width: 100%;
            height: 230px;
            object-fit: cover;
            border-bottom: 2px solid #4a9eff;
        }
        
        .page-info {
            padding: 12px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .status {
            text-align: center;
            padding: 15px;
            font-size: 1.1rem;
            color: #feb47b;
            min-height: 30px;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
            display: none;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #4a9eff, #6a5af9);
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .settings {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PDF to JPG</h1>
            <p class="subtitle">Convert your PDF documents to high-resolution JPG images directly in your browser. No server uploads, your files remain private.</p>
        </header>
        
        <main class="converter-section">
            <div class="upload-area" id="dropArea">
                <div class="upload-icon">üìÑ</div>
                <h2 class="upload-text">Drag & Drop your PDF file</h2>
                <p>or</p>
                <button class="btn" id="selectFileBtn">Select PDF File</button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf">
            </div>
            
            <div class="settings">
                <div class="setting-group">
                    <h3 class="setting-title"><span class="setting-icon">‚öôÔ∏è</span> Quality Settings</h3>
                    <p>JPG Quality: <span id="qualityValue" class="quality-value">95%</span></p>
                    <input type="range" min="50" max="100" value="95" class="quality-slider" id="qualitySlider">
                    <p class="quality-hint">Higher values = better quality & larger file size</p>
                </div>
                
                <div class="setting-group">
                    <h3 class="setting-title"><span class="setting-icon">üìè</span> Resolution (DPI)</h3>
                    <div class="dpi-select">
                        <div class="dpi-option selected" data-dpi="150">150 DPI</div>
                        <div class="dpi-option" data-dpi="200">200 DPI</div>
                        <div class="dpi-option" data-dpi="300">300 DPI</div>
                        <div class="dpi-option" data-dpi="400">400 DPI</div>
                    </div>
                    <p class="dpi-hint">Higher DPI = better resolution & larger image size</p>
                </div>
            </div>
            
            <div class="preview-section" id="previewSection">
                <h3 class="preview-title">Preview</h3>
                <div class="preview-container" id="previewContainer">
                    <!-- Preview images will be added here -->
                </div>
                
                <div class="action-buttons">
                    <button class="btn" id="downloadAllBtn" disabled>Download All as ZIP</button>
                    <button class="btn" id="convertBtn" disabled>Convert to JPG</button>
                </div>
            </div>
            
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="status" id="statusMessage">Ready to convert</div>
        </main>
        
        <footer>
            <p>All processing happens in your browser. Your files are never uploaded to any server.</p>
        </footer>
    </div>

    <script>
        // Initialize PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
        
        // DOM Elements
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const selectFileBtn = document.getElementById('selectFileBtn');
        const qualitySlider = document.getElementById('qualitySlider');
        const qualityValue = document.getElementById('qualityValue');
        const dpiOptions = document.querySelectorAll('.dpi-option');
        const previewSection = document.getElementById('previewSection');
        const previewContainer = document.getElementById('previewContainer');
        const convertBtn = document.getElementById('convertBtn');
        const downloadAllBtn = document.getElementById('downloadAllBtn');
        const statusMessage = document.getElementById('statusMessage');
        const progressContainer = document.getElementById('progressContainer');
        const progressBar = document.getElementById('progressBar');
        
        // State variables
        let pdfFile = null;
        let currentDPI = 300;
        let currentQuality = 95;
        let pagePreviews = [];
        
        // Event Listeners
        selectFileBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);
        qualitySlider.addEventListener('input', updateQuality);
        convertBtn.addEventListener('click', convertToJPG);
        downloadAllBtn.addEventListener('click', downloadAllAsZip);
        
        // Set up DPI selection
        dpiOptions.forEach(option => {
            option.addEventListener('click', () => {
                dpiOptions.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                currentDPI = parseInt(option.dataset.dpi);
            });
        });
        
        // Drag and drop functionality
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropArea.classList.add('highlight');
        }
        
        function unhighlight() {
            dropArea.classList.remove('highlight');
        }
        
        dropArea.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const file = dt.files[0];
            handleFile(file);
        }
        
        function handleFileSelect(e) {
            const file = e.target.files[0];
            handleFile(file);
        }
        
        function handleFile(file) {
            if (file && file.type === 'application/pdf') {
                pdfFile = file;
                statusMessage.textContent = `File selected: ${file.name}`;
                loadPDFPreview();
            } else {
                statusMessage.textContent = 'Please select a valid PDF file.';
            }
        }
        
        function updateQuality() {
            currentQuality = parseInt(qualitySlider.value);
            qualityValue.textContent = `${currentQuality}%`;
        }
        
        async function loadPDFPreview() {
            if (!pdfFile) return;
            
            statusMessage.textContent = "Loading PDF...";
            progressContainer.style.display = 'block';
            
            try {
                const pdfData = await readFileAsArrayBuffer(pdfFile);
                const pdf = await pdfjsLib.getDocument({ data: pdfData }).promise;
                const numPages = pdf.numPages;
                
                // Only preview first 3 pages to save resources
                const previewPages = Math.min(numPages, 3);
                previewContainer.innerHTML = '';
                pagePreviews = [];
                
                for (let i = 1; i <= previewPages; i++) {
                    updateProgress((i / previewPages) * 100);
                    const page = await pdf.getPage(i);
                    
                    // Create preview
                    const viewport = page.getViewport({ scale: 1.0 });
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.5);
                    pagePreviews.push(imgData);
                    
                    // Create preview element
                    const previewElement = document.createElement('div');
                    previewElement.className = 'page-preview';
                    previewElement.innerHTML = `
                        <img src="${imgData}" alt="Page ${i} Preview" class="preview-img">
                        <div class="page-info">Page ${i} of ${numPages}</div>
                    `;
                    previewContainer.appendChild(previewElement);
                }
                
                previewSection.style.display = 'flex';
                convertBtn.disabled = false;
                downloadAllBtn.disabled = false;
                statusMessage.textContent = `PDF loaded. ${numPages} pages detected.`;
            } catch (error) {
                console.error('Error loading PDF:', error);
                statusMessage.textContent = 'Error loading PDF. Please try another file.';
            } finally {
                progressContainer.style.display = 'none';
            }
        }
        
        async function convertToJPG() {
            if (!pdfFile) return;
            
            statusMessage.textContent = "Converting PDF to JPG...";
            progressContainer.style.display = 'block';
            convertBtn.disabled = true;
            downloadAllBtn.disabled = true;
            
            try {
                const pdfData = await readFileAsArrayBuffer(pdfFile);
                const pdf = await pdfjsLib.getDocument({ data: pdfData }).promise;
                const numPages = pdf.numPages;
                const zip = new JSZip();
                
                for (let i = 1; i <= numPages; i++) {
                    updateProgress((i / numPages) * 100);
                    statusMessage.textContent = `Processing page ${i} of ${numPages}...`;
                    
                    const page = await pdf.getPage(i);
                    const viewport = page.getViewport({ scale: currentDPI / 72 });
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;
                    
                    // Convert to JPG with specified quality
                    const imgData = canvas.toDataURL('image/jpeg', currentQuality / 100);
                    const imgBlob = dataURLToBlob(imgData);
                    
                    // Add to ZIP
                    zip.file(`page-${i}.jpg`, imgBlob);
                }
                
                // Generate and download ZIP
                const zipBlob = await zip.generateAsync({ type: 'blob' }, metadata => {
                    updateProgress(100 * metadata.percent);
                });
                
                saveAs(zipBlob, `converted-images-${new Date().getTime()}.zip`);
                statusMessage.textContent = `Conversion complete! Downloaded all ${numPages} pages.`;
            } catch (error) {
                console.error('Conversion error:', error);
                statusMessage.textContent = 'Error during conversion. Please try again.';
            } finally {
                convertBtn.disabled = false;
                downloadAllBtn.disabled = false;
                progressContainer.style.display = 'none';
            }
        }
        
        async function downloadAllAsZip() {
            await convertToJPG();
        }
        
        function updateProgress(percent) {
            progressBar.style.width = `${percent}%`;
        }
        
        // Helper functions
        function readFileAsArrayBuffer(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }
        
        function dataURLToBlob(dataURL) {
            const parts = dataURL.split(';base64,');
            const contentType = parts[0].split(':')[1];
            const raw = window.atob(parts[1]);
            const uInt8Array = new Uint8Array(raw.length);
            
            for (let i = 0; i < raw.length; ++i) {
                uInt8Array[i] = raw.charCodeAt(i);
            }
            
            return new Blob([uInt8Array], { type: contentType });
        }
    </script>
</body>
</html>